
-- Table Script 
CREATE TABLE PROTOCOL_PERSON_ROLE_MAPPING(
  ROLE_MAPPING_ID NUMBER(12) NOT NULL,
  SOURCE_ROLE_ID VARCHAR2(12) NOT NULL,
  TARGET_ROLE_ID VARCHAR2(12) NOT NULL,
  UPDATE_TIMESTAMP DATE, 
  UPDATE_USER VARCHAR2(60),
  VER_NBR NUMBER(8,0) DEFAULT 1 NOT NULL,
  OBJ_ID VARCHAR2(36) DEFAULT SYS_GUID() NOT NULL);


-- Primary Key Constraint 
ALTER TABLE PROTOCOL_PERSON_ROLE_MAPPING 
ADD CONSTRAINT PK_PERSON_ROLE_MAPPING 
PRIMARY KEY (ROLE_MAPPING_ID);


--Foreign Key Constraint(s) 
ALTER TABLE PROTOCOL_PERSON_ROLE_MAPPING 
ADD CONSTRAINT FK_PERSON_SOURCE_ROLE 
FOREIGN KEY (SOURCE_ROLE_ID) 
REFERENCES PROTOCOL_PERSON_ROLES (PROTOCOL_PERSON_ROLE_ID); 


ALTER TABLE PROTOCOL_PERSON_ROLE_MAPPING 
ADD CONSTRAINT FK_PERSON_TARGET_ROLE 
FOREIGN KEY (TARGET_ROLE_ID) 
REFERENCES PROTOCOL_PERSON_ROLES (PROTOCOL_PERSON_ROLE_ID); 


ALTER TABLE PROTOCOL_PERSON_ROLE_MAPPING 
ADD CONSTRAINT UQ_PERSON_MAPPING 
UNIQUE (SOURCE_ROLE_ID, TARGET_ROLE_ID); 

