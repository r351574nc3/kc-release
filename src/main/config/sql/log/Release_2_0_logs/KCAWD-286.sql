create sequence SEQ_AWARD_AMOUNT_TRANS_ID increment by 1 start with 1 nocache;

create sequence SEQ_TRANSACTION_DETAIL_ID increment by 1 start with 1 nocache;

alter table award_amount_info
add TNM_DOCUMENT_NUMBER VARCHAR2(10);

ALTER TABLE TIME_AND_MONEY_DOCUMENT
ADD SEQUENCE_NUMBER NUMBER(4) NOT NULL;

CREATE TABLE TRANSACTION_DETAILS(
TRANSACTION_DETAIL_ID NUMBER(10) NOT NULL,
AWARD_NUMBER VARCHAR2(12) NOT NULL,
SEQUENCE_NUMBER NUMBER(4) NOT NULL,
TRANSACTION_ID NUMBER(10) NOT NULL,
TNM_DOCUMENT_NUMBER VARCHAR2(10) NOT NULL,
COMMENTS VARCHAR2(200),
SOURCE_AWARD_NUMBER VARCHAR2(12) NOT NULL,
DESTINATION_AWARD_NUMBER VARCHAR2(12) NOT NULL,
OBLIGATED_AMOUNT NUMBER(12,2),
ANTICIPATED_AMOUNT NUMBER(12,2),
UPDATE_TIMESTAMP DATE NOT NULL, 
UPDATE_USER VARCHAR2(60) NOT NULL, 
VER_NBR NUMBER(8,0) DEFAULT 1 NOT NULL, 
OBJ_ID VARCHAR2(36) DEFAULT SYS_GUID() NOT NULL);

alter table TRANSACTION_DETAILS
add constraint PK_TRANSACTION_DETAILS
PRIMARY KEY (TRANSACTION_DETAIL_ID);

alter table TRANSACTION_DETAILS
add constraint FK_TRANSACTION_DETAILS3
FOREIGN KEY (TNM_DOCUMENT_NUMBER) 
REFERENCES TIME_AND_MONEY_DOCUMENT(document_Number);

-- Table Script 
CREATE TABLE AWARD_AMOUNT_TRANSACTION ( 
    AWARD_AMOUNT_TRANSACTION_ID NUMBER(12,0) NOT NULL, 
    AWARD_NUMBER VARCHAR2(12) NOT NULL, 
    TRANSACTION_ID VARCHAR2(10) NOT NULL, 
    TRANSACTION_TYPE_CODE NUMBER(3,0) NOT NULL, 
    NOTICE_DATE DATE, 
    COMMENTS VARCHAR2(2000), 
    UPDATE_TIMESTAMP DATE NOT NULL, 
    UPDATE_USER VARCHAR2(60) NOT NULL, 
    VER_NBR NUMBER(8,0) DEFAULT 1 NOT NULL, 
    OBJ_ID VARCHAR2(36) DEFAULT SYS_GUID() NOT NULL);


-- Primary Key Constraint 
ALTER TABLE AWARD_AMOUNT_TRANSACTION 
ADD CONSTRAINT PK_AWARD_AMOUNT_TRANSACTIONS 
PRIMARY KEY (AWARD_AMOUNT_TRANSACTION_ID);

ALTER TABLE AWARD_AMOUNT_TRANSACTION 
ADD CONSTRAINT FK_AWARD_AMOUNT_TRANSACTION1
FOREIGN KEY (TRANSACTION_TYPE_CODE) 
REFERENCES AWARD_TRANSACTION_TYPE(AWARD_TRANSACTION_TYPE_CODE);

ALTER TABLE AWARD_AMOUNT_TRANSACTION 
ADD CONSTRAINT FK_AWARD_AMOUNT_TRANSACTION3
FOREIGN KEY (TRANSACTION_ID) 
REFERENCES TIME_AND_MONEY_DOCUMENT(DOCUMENT_NUMBER);

ALTER TABLE AWARD_AMOUNT_TRANSACTION 
ADD CONSTRAINT UQ_AWARD_AMOUNT_TRANSACTIONS 
UNIQUE (AWARD_NUMBER, TRANSACTION_ID);
