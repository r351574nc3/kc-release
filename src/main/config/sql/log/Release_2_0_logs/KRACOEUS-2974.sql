CREATE VIEW VIEW_CO_C AS
SELECT C.FINAL_SUBMISSION_DATE FROM AWARD_CLOSEOUT C WHERE C.CLOSEOUT_REPORT_CODE = '1';

CREATE VIEW VIEW_CO_D AS
SELECT C.FINAL_SUBMISSION_DATE FROM AWARD_CLOSEOUT C WHERE C.CLOSEOUT_REPORT_CODE = '4';

CREATE VIEW VIEW_CO_E AS
SELECT C.FINAL_SUBMISSION_DATE FROM AWARD_CLOSEOUT C WHERE C.CLOSEOUT_REPORT_CODE = '3';

CREATE VIEW VIEW_CO_F AS
SELECT C.FINAL_SUBMISSION_DATE FROM AWARD_CLOSEOUT C WHERE C.CLOSEOUT_REPORT_CODE = '2';

CREATE OR REPLACE VIEW OSP$AWARD_CLOSEOUT AS 
SELECT A.AWARD_NUMBER MIT_AWARD_NUMBER,
A.SEQUENCE_NUMBER SEQUENCE_NUMBER,
C.FINAL_SUBMISSION_DATE FINAL_INV_SUBMISSION_DATE,
D.FINAL_SUBMISSION_DATE FINAL_TECH_SUBMISSION_DATE,
E.FINAL_SUBMISSION_DATE FINAL_PATENT_SUBMISSION_DATE,
F.FINAL_SUBMISSION_DATE FINAL_PROP_SUBMISSION_DATE,
B.ARCHIVE_LOCATION ARCHIVE_LOCATION,
B.CLOSEOUT_DATE CLOSEOUT_DATE,
A.UPDATE_TIMESTAMP UPDATE_TIMESTAMP,
A.UPDATE_USER UPDATE_USER
FROM AWARD_CLOSEOUT A, 
AWARD B,
VIEW_CO_C C,
VIEW_CO_D D,
VIEW_CO_E E,
VIEW_CO_F F
WHERE A.AWARD_NUMBER = B.AWARD_NUMBER AND A.SEQUENCE_NUMBER = B.SEQUENCE_NUMBER;

commit;