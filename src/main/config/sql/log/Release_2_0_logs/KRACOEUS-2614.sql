alter table PROPOSAL drop column IP_REVIEW_REQ_TYPE_CODE;
alter table PROPOSAL drop column REVIEW_SUBMISSION_DATE;
alter table PROPOSAL drop column REVIEW_RECEIVE_DATE;
alter table PROPOSAL drop column REVIEW_RESULT_CODE;
alter table PROPOSAL drop column IP_REVIEWER;
alter table PROPOSAL add PROPOSAL_SEQUENCE_STATUS varchar2(10) not null;


CREATE TABLE IP_REVIEW ( 
    IP_REVIEW_ID NUMBER(12,0) NOT NULL, 
    PROPOSAL_NUMBER VARCHAR2(8) NOT NULL, 
    SEQUENCE_NUMBER NUMBER(4,0) NOT NULL, 
    IP_REVIEW_REQ_TYPE_CODE NUMBER(3,0), 
    REVIEW_SUBMISSION_DATE DATE, 
    REVIEW_RECEIVE_DATE DATE, 
    REVIEW_RESULT_CODE NUMBER(3,0), 
    IP_REVIEWER VARCHAR2(9), 
    IP_REVIEW_SEQUENCE_STATUS varchar2(10) NOT NULL,
    UPDATE_TIMESTAMP DATE NOT NULL, 
    UPDATE_USER VARCHAR2(60) NOT NULL, 
    VER_NBR NUMBER(8,0) DEFAULT 1 NOT NULL, 
    OBJ_ID VARCHAR2(36) DEFAULT SYS_GUID() NOT NULL);

-- Primary Key Constraint 
ALTER TABLE IP_REVIEW 
ADD CONSTRAINT PK_IP_REVIEW 
PRIMARY KEY (IP_REVIEW_ID);

-- Table Script 
CREATE TABLE PROPOSAL_IP_REVIEW_JOIN ( 
    PROPOSAL_IP_REVIEW_JOIN_ID NUMBER(12,0) NOT NULL, 
    PROPOSAL_ID NUMBER(12,0) NOT NULL,
    IP_REVIEW_ID NUMBER(12,0),
    UPDATE_TIMESTAMP DATE NOT NULL, 
    UPDATE_USER VARCHAR2(60) NOT NULL,     
    VER_NBR NUMBER(8,0) DEFAULT 1 NOT NULL, 
    OBJ_ID VARCHAR2(36) DEFAULT SYS_GUID() NOT NULL);

-- Primary Key Constraint 
ALTER TABLE PROPOSAL_IP_REVIEW_JOIN
ADD CONSTRAINT PK_PROPOSAL_IP_REVIEW_JOIN
PRIMARY KEY (PROPOSAL_IP_REVIEW_JOIN_ID);

alter table PROPOSAL_IP_REV_ACTIVITY drop constraint FK_PROPOSAL_ID;

-- Foreign Key Constraint(s)
ALTER TABLE PROPOSAL_IP_REVIEW_JOIN 
ADD CONSTRAINT FK_PROPOSAL_ID 
FOREIGN KEY (PROPOSAL_ID) 
REFERENCES PROPOSAL (PROPOSAL_ID);

ALTER TABLE PROPOSAL_IP_REVIEW_JOIN 
ADD CONSTRAINT FK2_IP_REVIEW_ID 
FOREIGN KEY (IP_REVIEW_ID) 
REFERENCES IP_REVIEW (IP_REVIEW_ID);

alter table PROPOSAL_IP_REV_ACTIVITY drop column PROPOSAL_ID;

alter table PROPOSAL_IP_REV_ACTIVITY add IP_REVIEW_ID NUMBER(12,0) NOT NULL;

ALTER TABLE PROPOSAL_IP_REV_ACTIVITY 
ADD CONSTRAINT FK_IP_REVIEW_ID 
FOREIGN KEY (IP_REVIEW_ID) 
REFERENCES IP_REVIEW (IP_REVIEW_ID); 

CREATE SEQUENCE SEQ_IP_REVIEW_ID INCREMENT BY 1 START WITH 1 NOCACHE;

CREATE SEQUENCE SEQ_PROPOSAL_IP_REVIEW_JOIN_ID INCREMENT BY 1 START WITH 1 NOCACHE;
