create or replace PROCEDURE GET_PROP_LOCATION_LIST(

    AW_PROPOSAL_NUMBER IN     OSP$EPS_PROP_LOCATION.PROPOSAL_NUMBER%TYPE ,
    CUR_GENERIC        IN OUT RESULT_SETS.CUR_GENERIC )

IS
BEGIN

  OPEN CUR_GENERIC FOR
   SELECT
      S.PROPOSAL_NUMBER ,
      S.LOCATION_NAME as LOCATION,
      S.ROLODEX_ID ,
	  s.site_number,
	  fn_get_cong_dist(aw_proposal_number,s.site_number) as CongDist,
      OSP$ROLODEX.ORGANIZATION ,
      OSP$ROLODEX.ADDRESS_LINE_1 ,
      OSP$ROLODEX.ADDRESS_LINE_2 ,
      OSP$ROLODEX.ADDRESS_LINE_3 ,
      OSP$ROLODEX.CITY ,
      OSP$ROLODEX.COUNTY ,
      OSP$ROLODEX.STATE ,
      OSP$ROLODEX.POSTAL_CODE ,
      OSP$ROLODEX.COUNTRY_CODE 
    FROM
      OSP$EPS_PROP_SITES S,
      OSP$ROLODEX
    WHERE
	 (S.LOCATION_TYPE_CODE = 4 OR S.LOCATION_TYPE_CODE=3) AND
      S.PROPOSAL_NUMBER =  AW_PROPOSAL_NUMBER  AND
      S.ROLODEX_ID = OSP$ROLODEX.ROLODEX_ID (+)
    ORDER BY
      S.LOCATION_NAME ASC ;

END;
/


