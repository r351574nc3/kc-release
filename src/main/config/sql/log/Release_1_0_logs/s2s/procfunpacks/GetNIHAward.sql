CREATE OR REPLACE PROCEDURE Getnihaward ( as_proposal_number IN OSP$EPS_PROPOSAL.PROPOSAL_NUMBER%TYPE,
              cur_generic IN OUT Result_Sets.cur_generic) IS

BEGIN

 OPEN cur_generic FOR
	SELECT	DECODE(A.SPONSOR_PROPOSAL_NUMBER, NULL, ' ', A.SPONSOR_PROPOSAL_NUMBER) AWARD_NUMBER,
		DECODE(	A.SPONSOR_PROPOSAL_NUMBER, NULL, ' ', SUBSTR(A.SPONSOR_PROPOSAL_NUMBER,3,3)) ACTIVITY_CODE,
         	DECODE(A.SPONSOR_PROPOSAL_NUMBER, NULL, ' ', SUBSTR(A.SPONSOR_PROPOSAL_NUMBER, 1, 1)) AWARD_TYPE
	FROM		OSP$EPS_PROPOSAL A
	WHERE		A.PROPOSAL_NUMBER = AS_PROPOSAL_NUMBER;


 /*
 SELECT A.SPONSOR_AWARD_NUMBER AWARD_NUMBER,
      SUBSTR(A.sponsor_award_number,3,3) ACTIVITY_CODE,
          SUBSTR(A.sponsor_award_number, 1, 1) AWARD_TYPE
 FROM  OSP$AWARD A, OSP$EPS_PROPOSAL P
 WHERE  P.PROPOSAL_NUMBER = AS_PROPOSAL_NUMBER
 AND      P.CURRENT_AWARD_NUMBER = A.MIT_AWARD_NUMBER
   AND      A.SEQUENCE_NUMBER = (SELECT MAX(SEQUENCE_NUMBER) FROM OSP$AWARD WHERE
             MIT_AWARD_NUMBER = A.MIT_AWARD_NUMBER);
*/

END;
/

