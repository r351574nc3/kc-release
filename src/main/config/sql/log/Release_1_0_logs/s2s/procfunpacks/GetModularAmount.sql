CREATE OR REPLACE PROCEDURE GetModularAmount (AS_PROPOSAL_NUMBER IN OSP$EPS_PROPOSAL.PROPOSAL_NUMBER%TYPE,
 															  AI_VERSION  IN OSP$BUDGET.VERSION_NUMBER%TYPE,
														     AI_BUDGET_PERIOD IN OSP$BUDGET_PERIODS.BUDGET_PERIOD%TYPE,
															  CUR_GENERIC IN OUT result_sets.cur_generic) IS



BEGIN

open cur_generic for

--	SELECT	(CEIL(TOTAL_DIRECT_COST / 25000 ) * 25000) MODAMOUNT
--	FROM  	OSP$BUDGET_PERIODS
--	WHERE    PROPOSAL_NUMBER = AS_PROPOSAL_NUMBER
--	AND		VERSION_NUMBER = AI_VERSION
--	AND		BUDGET_PERIOD = AI_BUDGET_PERIOD;


SELECT TOTAL_DIRECT_COST AS MODAMOUNT
FROM   OSP$BUDGET_MODULAR
WHERE  PROPOSAL_NUMBER = AS_PROPOSAL_NUMBER
AND    BUDGET_PERIOD=AI_BUDGET_PERIOD
AND    VERSION_NUMBER = AI_VERSION;

end;
/

