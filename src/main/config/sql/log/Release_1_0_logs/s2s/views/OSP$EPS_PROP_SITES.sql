CREATE OR REPLACE VIEW OSP$EPS_PROP_SITES (
   PROPOSAL_NUMBER,
   SITE_NUMBER,
   LOCATION_NAME,
   LOCATION_TYPE_CODE,
   ORGANIZATION_ID,
   ROLODEX_ID,
   UPDATE_TIMESTAMP,
   UPDATE_USER) 
       AS 
       (select
       P.PROPOSAL_NUMBER, 
       rownum,   
       O.ORGANIZATION_NAME,
   	   1,
       P.ORGANIZATION_ID,
       O.CONTACT_ADDRESS_ID,
       P.UPDATE_TIMESTAMP,
       P.UPDATE_USER from OSP$EPS_PROPOSAL P,OSP$ORGANIZATION O
       			   where P.ORGANIZATION_ID=O.ORGANIZATION_ID)
       union
       (select
       P.PROPOSAL_NUMBER, 
       rownum,   
       O.ORGANIZATION_NAME,
   	   2,
       P.ORGANIZATION_ID,
       O.CONTACT_ADDRESS_ID,
       P.UPDATE_TIMESTAMP,
       P.UPDATE_USER from OSP$EPS_PROPOSAL P,OSP$ORGANIZATION O
       			   where P.PERFORMING_ORGANIZATION_ID=O.ORGANIZATION_ID)
       union
       (SELECT 
       	P.PROPOSAL_NUMBER,
       	rownum,
       	L.LOCATION, 
       	4,
       	null,
       	null,
       	L.UPDATE_TIMESTAMP,
       	L.UPDATE_USER
		 FROM OSP$EPS_PROP_LOCATION L,OSP$EPS_PROPOSAL P
		 where L.PROPOSAL_NUMBER = P.PROPOSAL_NUMBER)
       ;
